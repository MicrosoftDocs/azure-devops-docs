---
title: Dataset design for the Power BI VSTS Connector
titleSuffix: VSTS
description: Describes dataset that is created in Power BI for an Analytics View for Visual Studio Team Services 
ms.technology: devops-analytics
ms.prod: devops
ms.assetid: 8E92B372-B312-4BAD-960A-B3CB0202E2A1  
ms.manager: douge
ms.reviewer: jozimm
ms.author: kaelli
author: KathrynEE
ms.topic: reference
monikerRange: 'vsts'
ms.date: 04/04/2018
---

# Dataset design for the Power BI Connector for Visual Studio Team Services (VSTS)

[!INCLUDE [temp](../../_shared/version-vsts-only.md)]

Each Analytics view defines a dataset in Power BI. Datasets are the tables and properties used to create visualizations. The datasets generated by the [Power BI Data Connector for VSTS](../powerbi/data-connector-connect.md) have the following characteristics:

* The entities and associated fields available from Analytics are flattened (denormalized) into a single table. For example, the user name in "Created By" is modeled as a string (User Name), rather than the user ID. This eliminates the need to create relationships between tables to create reports.
* Historical data is modeled as snapshots for each time period, so trending reporting is extremely simple.

To learn more about Power BI and datasets, see [Power BI - basic concepts for Power BI service](https://docs.microsoft.com/power-bi/service-basic-concepts).


[!INCLUDE [temp](../_shared/analytics-view-availability.md)]


## Flattening the Analytics OData endpoint

The Analytics OData endpoint provides a normalized representation of the data in VSTS. The data is normalized primarily to support reporting on the "many-to-many" relationships that exist between the data, such as work items and  associated tags. 

The VSTS Power BI Data Connector represents this data as a single table so that the relationships shown in our [Analytics Service data model](../extend-analytics/data-model-analytics-service.md) do not need to be recreated in Power BI, allowing you to filter on a complex field like tags immediately. 

The process greatly simplifies getting your reports up and running. However, not all of the fields available through the Analytics OData endpoint are available for selection in an Analytics View. 

## Selectable fields in Analytics views

The fields you can select in an Analytics view correspond to regular work tracking fields and Analytics data store fields. 

### Work tracking fields

You can select all work tracking fields in an Analytics view, except for the following fields:  
 
* Fields that aren't part of the *project* where the view was created
* Long text fields such as Description, History, and other fields with an HTML data type  
* Work item link count fields such as ExternalLinkCount, HyperLinkCount, AttachedFileCount, RelatedLinkCount
* Specific REST API Fields, such as Watermark, IsDeleted
* Fields with *many-to-many* relationships, such as Team, Board Column, Board Name

<!--- to my knowledge, Team isn't a field defined out-of-the-box --> 

> [!IMPORTANT]  
> Identity or person-name fields, such as Created By, Assigned To, etc., are selectable fields, however you can't select these fields at this time as field criteria for the purposes of filtering work items. 

For a description of each work item tracking fields, see [Work item field index](../../work/work-items/guidance/work-item-field.md).


### Analytics data store fields 

You can select the following Analytics-based fields in an Analytics view:

> [!div class="mx-tdCol2BreakAll"]
> |  Field  | Description |
> |------|---------|
> | Cycle Time | Time for a work item to move from a state category of "In Progress" to "Completed" | 
> | Date (included automatically with history) | Supports viewing the daily, weekly, or monthly history of the filtered set of work items |
> | Is Current (included automatically with history) | Supports filtering the data to view the most recent snapshot of the filtered set of work items by setting the value to `True` | 
> | Lead Time | Time for a work item to move from a state category of "Proposed" to "Completed" | 
> | Parent Work Item Id | The Work Item Id for the parent of a work item | 
> | Project Name | Equivalent to the Team Project field  | 
> | Revision | A number that is assigned to the historical revision of a work item  | 
> | Tags | Semicolon delimited list of Tags | 
> | WorkItemRevisionSK | The Analytics unique key for the work item revision, used to join related entities | 

For information about state categories, see [Workflow states and state categories](../../work/customize/workflow-and-state-categories.md). For more detailed information on the Analytics service data model, see [Data model for the Analytics Service](../extend-analytics/data-model-analytics-service.md). 

To access any additional fields available through the [Analytics service](../extend-analytics/analytics-metadata.md), include the corresponding Surrogate Keys(SK) or Work Item Id in the Analytics view and create the necessary mapping tables based on the Analytics Navigational Property. 

* Iterations (IterationSK)
* Areas (AreaSK)
* Teams (AreaSK - generate mapping Table based on *Teams* Navigational Property) 
* BoardLocations (AreaSK - generate mapping Table based on *BoardLocations* Navigational Property)
* Dates (DateSK)
* Process (AreaSK - generate mapping Table based on *Process* Navigational Property)
* WorkItemLinks (Work Item Id)

## Historical data modeling

The Analytics service models historical data as a **periodic snapshot fact table**. The fact table contains one row created at midnight for each work item at the end of each period. For example, history on a daily period is modeled as one row at midnight for each day, while a weekly period would be one row at midnight of the last day of the week. If the week has not completed, the snapshot value for the week is based on the current value.

The grain of this table is the period, not the individual work item. This means that **a single Work Item will appear multiple times**, once for each historical period. Selecting the last 30 days of history will result in a single work item appearing 30 times in the data model. If the work item has not changed within the last 30 days, the most recent revision of the work item is replicated on each day.

When working with the VSTS Power BI Data Connector and historical data, we recommend using the <code>Date</code> field.  **If the dataset contains historical data, but only the current values are needed, this can be setup by filtering `Is Current`**.  

For example, if you want to show a table of work items and values for the associated fields you would use `Is Current` as a filter which is set to True. If you wanted instead to show a trend of work items based on state you would include the Date column on the Axis of the visualization.  

> [!TIP]  
> Always use the **Date** option when using the Date column. The Date field is not intended to support default Hierarchies in Power BI.

![](./_img/data-connector-date.png)

## Related articles  
- [Data model for the Analytics Service](../extend-analytics/data-model-analytics-service.md)
- [Power BI integration overview](overview.md)  
- [Work item field index](../../work/work-items/guidance/work-item-field.md)
- [Work item categories](../../work/customize/reference/use-categories-to-group-work-item-types.md)
- [Backlogs, boards, and plans](../../work/backlogs/backlogs-boards-plans.md)
- [Connect to VSTS with Power BI Data Connector](./data-connector-connect.md)
- [Data Connector - Example reports](./data-connector-examples.md)
- [Functions available in Power BI Data Connector](data-connector-functions.md) 

   
